\documentclass[conference]{IEEEtran}

\input{overleafsettings-PS-PM.tex}

\begin{document}

\title{2D Sonar Simulator\\
} 


\author{\IEEEauthorblockN{Camille Wardlaw}
\IEEEauthorblockA{\textit{EECS Department} \\
cwardlaw@mit.edu}
\and
\IEEEauthorblockN{Manuel Valencia}
\IEEEauthorblockA{\textit{EECS Department}\\
manuelv@mit.edu}
\and
\IEEEauthorblockN{Demircan Tas}
\IEEEauthorblockA{\textit{EECS Department}\\
tasd@mit.edu}
}

\maketitle

\vspace{0.5cm}

\begin{abstract}
Anthropogenic underwater noise from ships, construction, and sonar systems poses risks to marine ecosystems, yet computationally efficient prediction of acoustic propagation in complex ocean environments remains challenging. We present a 2D acoustic wave propagation simulator using finite difference time domain (FDTD) methods to model sound transmission from point sources. The simulator solves the acoustic wave equation using finite difference methods in space and time, enabling rapid assessment of sound pressure levels and propagation patterns across varying environmental conditions. This tool supports evaluation of noise mitigation strategies for marine habitat protection and informed sonar system design.
\end{abstract}

\section{Introduction \& Motivations}
\label{intro}
The ocean is naturally noisy. Sounds are generated by wind, waves, rain, ice dynamics, earthquakes, and biological sources such as snapping shrimp and vocalizing marine fauna~\cite{Erbe2025}. Since the industrial revolution, anthropogenic activities—particularly mechanized shipping and offshore industrial operations—have added significant noise to and even dominated ocean soundscapes. As seen in Fig.~\ref{fig:SoundScape}, heavy ship traffic is the loudest source of ambient noise at mid-frequencies. The concern is that these anthropogenic noises may interfere with marine animal communication, environmental sensing, behavior, and ultimately survival. To assess and mitigate noise impacts on marine ecosystems, the acoustic characteristics of different noise sources in different environments must be quantified~\cite{Lucke2024}.

\begin{figure}[htbp]
\centerline{\includegraphics[width=8cm]{soundscape.png}}
\caption{Spectra of prevailing and local underwater sound sources~\cite{Erbe2025}}
\label{fig:SoundScape}
\end{figure}


 Even within specific environments, ocean conditions are extremely dynamic. Temperature profiles shift with seasons, currents fluctuate, and wind conditions change daily, all of which affect sound propagation. Physical measurements provide snapshots of the current acoustic environment, but they are expensive, weather-dependent, and spatially limited. Numerical simulation tools enable evaluation of acoustic propagation across a range of environmental conditions, supporting parametric studies essential for regulatory planning.

Existing ocean acoustic models~\cite{Wang2014} are powerful but often require specialized expertise, proprietary software, or substantial computational resources. For environmental impact assessments, accessible tools that can rapidly evaluate sound pressure levels from a variety of sources (ships, construction, sonar) are needed. Here, a 2D finite difference time domain (FDTD) simulator provides a computationally efficient, flexible approach for modeling sound propagation in these scenarios. 


\section{Problem formulation}
The simulator models acoustic pressure wave propagation on a uniform rectangular grid in $(x,z)$ space, where $x$ represents horizontal distance and $z$ represents depth. Each grid point $(i,j)$ represents a small control volume of fluid where $i \in [0,N_x-1]$ and $j \in [0,N_z-1]$. We use nodal formulation with nodes at grid points. To model pressure propagation, we use the scalar acoustic wave equation with linear damping:
\begin{equation}
\frac{\partial^2 p}{\partial t^2} + \alpha \frac{\partial p}{\partial t} = c^2 \nabla^2 p + s(x,z,t)
\end{equation}
where $p(x,z,t)$ is acoustic pressure [Pa], $c$ is the speed of sound [m/s], $\alpha$ is a bulk absorption coefficient [1/s], and $s$ is the source term [Pa/s$^2$]. Introducing $w=\partial p/\partial t$ [Pa/s], the second-order PDE becomes a first-order system suitable for time integration.

The state vector contains acoustic pressure $p_{i,j}$ and its time derivative $w_{i,j}$ at each grid point:
\begin{equation}
x = [p_{1,1}, p_{1,2}, \ldots, p_{N_x,N_z}, w_{1,1}, w_{1,2}, \ldots, w_{N_x,N_z}]^T \in \mathbb{R}^{2N}
\end{equation}
where $N = N_x \times N_z$ is the total number of grid points. The physical and geometric parameters of the system are:
\begin{equation}
\begin{split}
p = [c, \alpha, N_x, N_z, L_x, L_z, \Delta x, \Delta z, i_{src}, j_{src}, \\
     i_{rx,1}, \ldots, i_{rx,H}, j_{rx,1}, \ldots, j_{rx,H}]^T
\end{split}
\end{equation}
where $c$ is sound speed [m/s], $\alpha$ is absorption coefficient [1/s], $N_x, N_z$ are the number of grid points in $x$ and $z$ directions, $L_x, L_z$ are domain dimensions [m], $\Delta x, \Delta z$ are grid spacings [m], $(i_{src}, j_{src})$ is the source location index, and $(i_{rx,h}, j_{rx,h})$ for $h=1,\ldots,H$ are hydrophone receiver location indices.

The input excitation is a Gaussian-windowed sinusoidal pulse from the acoustic source:
\begin{equation}
u(t) = A_0 \sin(2\pi f_0 t) \exp\left[-\frac{(t-t_0)^2}{\sigma^2}\right]
\end{equation}
where $A_0$ is amplitude, $f_0$ is center frequency [Hz], $t_0$ is pulse center time [s], and $\sigma$ controls pulse duration [s].

The Laplacian operator $\nabla^2 p$ is approximated using a 5-point finite-difference stencil:
\begin{equation}
(\nabla^2 p)_{i,j} \approx \frac{p_{i+1,j}-2p_{i,j}+p_{i-1,j}}{\Delta x^2} + \frac{p_{i,j+1}-2p_{i,j}+p_{i,j-1}}{\Delta z^2}
\end{equation}
Boundary conditions modify the discrete Laplacian $L$: the top boundary (sea surface) uses a pressure-release condition ($p=0$), the bottom boundary (seafloor) uses a rigid wall condition ($\partial p/\partial z=0$), and the left/right boundaries use an absorbing boundary approximation (one-sided stencil).

The discretized system can be written as $\dot{\mathbf{x}} = A\mathbf{x} + Bu(t)$ where:
\begin{equation}
A = \begin{bmatrix}
0_{N\times N} & I_{N} \\
c^2 L & -\alpha I_{N}
\end{bmatrix}, \qquad
B = \begin{bmatrix} 0 \\ b \end{bmatrix}
\end{equation}
Here $L \in \mathbb{R}^{N\times N}$ is the discrete Laplacian matrix and $b \in \mathbb{R}^{N}$ is the spatial source distribution with a single nonzero entry $b_{k_{src}} = 1/(\Delta x \Delta z)$ at the source location. The complete system of ODEs in standard form is:
\begin{eqnarray}
\label{eqn:StateSpaceModel}
\frac{dp_{i,j}}{dt} &=& w_{i,j} \quad \text{for all } (i,j) \nonumber \\
\frac{dw_{i,j}}{dt} &=& c^2 (L p)_{i,j} - \alpha w_{i,j} + b_{i,j} u(t) \quad \text{for all } (i,j) \nonumber
\end{eqnarray}
where $(L p)_{i,j}$ denotes the discretized Laplacian applied to the pressure field. This defines the dynamical system $\frac{dx}{dt}=f(x,p,u)$ where $f$ implements the equations above.

The quantities of interest are the received acoustic pressures at hydrophone locations:
\begin{equation}
y = [p_{i_{rx,1},j_{rx,1}}(t), p_{i_{rx,2},j_{rx,2}}(t), \ldots, p_{i_{rx,H},j_{rx,H}}(t)]^T \in \mathbb{R}^{H}
\end{equation}
In compact state-space form: $\mathbf{y}(t) = C \mathbf{x}(t)$, where $C \in \mathbb{R}^{H \times 2N}$ is a selector matrix that extracts the pressure components at the hydrophone indices:
\begin{equation}
y_h = p_{i_{rx,h},j_{rx,h}}(t) = g_h(x,p,u) \quad \text{for } h=1,\ldots,H
\end{equation}



\section{Fundamental Numerical Methods} 

\section{The Technical Challenge} 

\section{Results}
\label{sec:results}

This section will present validation and performance results for the 2D acoustic wave propagation simulator organized into three categories: verification, computational efficiency, and limitations. \\

\textbf{Simulation Parameters:}
\begin{itemize}
\item Medium properties: seawater density $\rho = 1025$ kg/m$^3$, sound speed $c = 1500$ m/s
\item Absorption coefficient: $\alpha = 0.1$ s$^{-1}$
\item Domain size: $L_x = 500$ m (horizontal), $L_z = 100$ m (depth)
\item Spatial resolution: $\Delta x = \Delta z = 0.5$ m ($N_x = 1000$, $N_z = 200$ grid points)
\item Time step: $\Delta t$ selected to satisfy CFL stability condition
\item Source signal: Gaussian-windowed sinusoid, $f_0 = 20$ Hz, pulse duration 100 ms
\item Source location: $(x_{src}, z_{src}) = (50, 50)$ m
\item Programming language: Python 3.11 \\
\end{itemize} 

\vspace{2pt}
\textbf{Figure 1: Validation with Spherical Spreading Law}
\begin{figure}[H]
\centerline{[Placeholder: Single plot with axes]}
\caption{\textbf{Planned content:} Comparison of simulated pressure amplitude decay with analytical spherical spreading law ($1/r$) in a homogeneous medium. X-axis: Distance from source (0-400 m). Y-axis: Normalized pressure amplitude (0-1, linear scale) or Sound Pressure Level (dB re 1 m). Plot will show: (1) Analytical $1/r$ curve (solid black line), (2) Simulated pressure values extracted along horizontal transect at source depth (red circles). The purpose is to verify that the simulator correctly models geometric spreading in the near field before boundary interactions dominate.}
\label{fig:verification_spreading}
\end{figure}

\textbf{Figure 2: 3D Wave Propagation Visualization}
\begin{figure}[htbp]
\centerline{[Placeholder: 3D surface plot of wave amplitude evolution]}
\caption{\textbf{Planned content:} Three-dimensional visualization of acoustic wave propagation showing pressure amplitude across the spatial domain. X-axis: Horizontal range (0-500 m). Y-axis: Depth (0-100 m). Z-axis: Pressure amplitude (Pa). The 3D surface represents the instantaneous pressure field at a specific time. An animated sequence of such plots will demonstrate temporal wave evolution. The animation will show: spherical wavefront expanding from source location (marked), compressions (positive pressure, elevated surface) and rarefactions (negative pressure, depressed surface), reflections from sea surface (top boundary, $z=0$) and seafloor (bottom boundary, $z=100$ m), and amplitude decay with distance from source. Colormap on surface will enhance visualization of pressure variations.}
\label{fig:wave_propagation_3d}
\end{figure}

\textbf{Table 1: Computational Performance Metrics}
\begin{table}[htbp]
\caption{\textbf{Planned comparison of computational requirements}}
\begin{center}
\begin{tabular}{|c|c|c|c|c|}
\hline
\textbf{Grid Size} & \textbf{State Size} & \textbf{Time Steps} & \textbf{Wall Time} & \textbf{Memory} \\
\textbf{$N_x \times N_z$} & \textbf{(2N)} & & \textbf{(seconds)} & \textbf{(MB)} \\
\hline
$100 \times 100$ & 20,000 & [TBD] & [TBD] & [TBD] \\
\hline
$500 \times 100$ & 100,000 & [TBD] & [TBD] & [TBD] \\
\hline
$1000 \times 200$ & 400,000 & [TBD] & [TBD] & [TBD] \\
\hline
$2000 \times 400$ & 1,600,000 & [TBD] & [TBD] & [TBD] \\
\hline
\end{tabular}
\label{table:performance}
\end{center}
\end{table}

\textbf{Figure 3: Stability Boundary and Time Step Constraints}
\begin{figure}[H]
\centerline{[Placeholder: 2x1 subplot layout]}
\caption{\textbf{Planned content:} (Top) Maximum stable time step vs. spatial resolution. X-axis: Grid spacing $\Delta x$ (m). Y-axis: Maximum stable $\Delta t$ (seconds). Solid line shows theoretical CFL limit: $\Delta t_{max} = \alpha_{CFL} \min(\Delta x, \Delta z)/c$. Points show experimentally determined stability boundary. (Bottom) Example of unstable simulation: pressure field showing numerical artifacts when $\Delta t$ exceeds CFL limit. This plot is intended to quantify stability constraints and demonstrate failure mode when violated.}
\label{fig:stability}
\end{figure}


\section{Technical Discussion}

\section{Ethics \& Limitations}

\section{Conclusions}

\clearpage
\begin{thebibliography}{00}
\bibitem{Erbe2025} C. Erbe et al., ``Sources of underwater noise,'' in C. Erbe, D. Houser, A. Bowles, and M. B. Porter, Eds., \textit{Marine Mammal Acoustics in a Noisy Ocean}. Springer, Cham, 2025, ch. 2. [Online]. Available: https://doi.org/10.1007/978-3-031-77022-7\_2

\bibitem{Lucke2024} K. Lucke, A. O. MacGillivray, M. B. Halvorsen, M. A. Ainslie, D. G. Zeddies, and J. A. Sisneros, ``Recommendations on bioacoustical metrics relevant for regulating exposure to anthropogenic underwater sound,'' \textit{J. Acoust. Soc. Am.}, vol. 156, no. 4, pp. 2508--2526, Oct. 2024. [Online]. Available: https://doi.org/10.1121/10.0028586

\bibitem{Wang2014} L. Wang, K. Heaney, T. Pangerc, P. Theobald, S. Robinson, and M. Ainslie, ``Review of underwater acoustic propagation models,'' National Physical Laboratory, Tech. Rep. NPL AC 12, Oct. 2014. [Online]. Available: https://eprintspublications.npl.co.uk/6340/1/AC12.pdf
\end{thebibliography}

\onecolumn

\end{document}
